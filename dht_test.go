package main

import (
	"testing"

	"github.com/gogo/protobuf/proto"
	ptp "github.com/subutai-io/p2p/lib"
)

func TestRouteData(t *testing.T) {

	data := []ptp.DHTPacket{
		ptp.DHTPacket{},
		ptp.DHTPacket{
			Type: ptp.DHTPacketType_Ping,
		},
		ptp.DHTPacket{
			Type: ptp.DHTPacketType_Ping,
			Arguments: []string{
				"999999999999999999999999999999999999999999999999999999999999",
				"999999999999999999999999999999999999999999999999999999999999",
				"999999999999999999999999999999999999999999999999999999999999",
				"999999999999999999999999999999999999999999999999999999999999",
				"999999999999999999999999999999999999999999999999999999999999",
				"999999999999999999999999999999999999999999999999999999999999",
				"999999999999999999999999999999999999999999999999999999999999",
				"999999999999999999999999999999999999999999999999999999999999",
				"999999999999999999999999999999999999999999999999999999999999",
				"999999999999999999999999999999999999999999999999999999999999",
				"999999999999999999999999999999999999999999999999999999999999",
				"999999999999999999999999999999999999999999999999999999999999",
				"999999999999999999999999999999999999999999999999999999999999",
				"999999999999999999999999999999999999999999999999999999999999",
				"999999999999999999999999999999999999999999999999999999999999",
				"999999999999999999999999999999999999999999999999999999999999",
				"999999999999999999999999999999999999999999999999999999999999",
				"999999999999999999999999999999999999999999999999999999999999",
				"999999999999999999999999999999999999999999999999999999999999",
				"999999999999999999999999999999999999999999999999999999999999",
				"999999999999999999999999999999999999999999999999999999999999",
				"999999999999999999999999999999999999999999999999999999999999",
				"999999999999999999999999999999999999999999999999999999999999",
				"999999999999999999999999999999999999999999999999999999999999",
				"999999999999999999999999999999999999999999999999999999999999",
				"999999999999999999999999999999999999999999999999999999999999",
				"999999999999999999999999999999999999999999999999999999999999",
				"999999999999999999999999999999999999999999999999999999999999",
				"999999999999999999999999999999999999999999999999999999999999",
				"999999999999999999999999999999999999999999999999999999999999",
			},
		},
	}

	router := new(DHTRouter)
	for _, d := range data {
		b, _ := proto.Marshal(&d)
		if len(b) > 1024 {
			b = b[:1024]
		}
		router.routeData(b)
	}
}
